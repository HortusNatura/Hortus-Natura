var P=Object.defineProperty;var v=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var j=(a,t,s)=>t in a?P(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,C=(a,t)=>{for(var s in t||(t={}))w.call(t,s)&&j(a,s,t[s]);if(v)for(var s of v(t))y.call(t,s)&&j(a,s,t[s]);return a};import{i as M,r,j as i}from"./main-577.js";import{e as F,_ as R,d as n}from"./bi.655.81.js";import{S as E}from"./bi.880.909.js";import{e as L}from"./bi.787.676.js";import{I as T}from"./bi.672.677.js";import O from"./bi.146.314.js";import{h as z,c as N}from"./bi.317.877.js";import{S as A}from"./bi.414.878.js";import"./bi.827.680.js";import"./bi.587.674.js";import"./bi.934.737.js";import"./bi.622.681.js";function $({formFields:a,setFlow:t,flow:s,allIntegURL:f}){const u=M(),[g,d]=r.useState(!1),[S,h]=r.useState({}),[o,x]=r.useState(1),[I,p]=r.useState({show:!1}),[e,c]=r.useState({name:"Salesmate",type:"Salesmate",session_token:"",link_name:"",field_map:[{formField:"",salesmateFormField:""}],actionName:"",actionId:"",salesmateFields:[],actions:{}}),_=()=>{d(!0),L(s,t,f,e,u,"","",d).then(m=>{var b;m.success?(n.success((b=m.data)==null?void 0:b.msg),u(f)):n.error(m.data||m)})},k=l=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!N(e)){n.error("Please map mandatory fields");return}if(!e.selectedCRMOwner){n.error("Please select a Owner");return}if(Number(e.actionId)===4){if(!e.selectedCRMContact){n.error("Please select a Contact");return}if(!e.selectedCRMPipeline){n.error("Please select a Pipeline");return}if(!e.selectedCRMStage){n.error("Please select a Stage");return}}e.field_map.length>0&&x(l)};return i.jsxs("div",{children:[i.jsx(F,{snack:I,setSnackbar:p}),i.jsx("div",{className:"txt-center mt-2",children:i.jsx(E,{step:3,active:o})}),i.jsx(O,{salesmateConf:e,setSalesmateConf:c,step:o,setStep:x,loading:S,setLoading:h,setSnackbar:p}),i.jsxs("div",{className:"btcd-stp-page",style:C({},o===2&&{width:900,height:"auto",overflow:"visible"}),children:[i.jsx(A,{formFields:a,handleInput:l=>z(l,e,c),salesmateConf:e,setSalesmateConf:c,loading:S,setLoading:h,isLoading:g,setIsLoading:d,setSnackbar:p}),(e==null?void 0:e.actionName)&&i.jsxs("button",{onClick:()=>k(3),disabled:!N(e),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[R("Next","bit-integrations")," ","Â ",i.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(e==null?void 0:e.actionName)&&i.jsx(T,{step:o,saveConfig:()=>_(),isLoading:g,dataConf:e,setDataConf:c,formFields:a})]})}export{$ as default};
