var J=Object.defineProperty;var w=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var k=(o,c,r)=>c in o?J(o,c,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[c]=r,u=(o,c)=>{for(var r in c||(c={}))K.call(c,r)&&k(o,r,c[r]);if(w)for(var r of w(c))Q.call(c,r)&&k(o,r,c[r]);return o};import{r as p,i as V,j as e}from"./main-577.js";import{c as T,e as W,i as a,a6 as X,L as Y}from"./bi.655.81.js";import{e as Z}from"./bi.787.676.js";import{P as g,a as f,c as ee,b as te}from"./bi.792.711.js";import{p as ie}from"./bi.895.712.js";import{C as se}from"./bi.827.680.js";import{T as I,t as ae}from"./bi.934.737.js";import"./bi.587.674.js";import"./bi.622.681.js";import"./bi.933.682.js";import"./bi.265.683.js";function je({formFields:o,setFlow:c,flow:r,allIntegURL:M}){var _,N,y;const[$,D]=p.useState([]),[E,L]=p.useState([]),[O,q]=p.useState([]),[j,A]=p.useState([]),U=V(),[z,v]=p.useState(!1),{podLinks:l}=ae,[i,m]=p.useState({name:"Pods",type:"Pods",post_map:[{post_author:"logged_in_user"}],pod_field_map:[{}],pod_file_map:[{}],condition:{action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}}),[B,h]=p.useState({show:!1}),b=(t,s,d)=>{const n=u({},i);d?n[t]=Number(s):n[t]=s,m(n)},G=(t,s)=>{const d=u({},i);d[t]=s,T({post_type:s},"pods/fields").then(n=>{var F,P,S,C;n!=null&&n.success&&n!==void 0&&(D(Object.values((F=n==null?void 0:n.data)==null?void 0:F.podFields)),L(Object.values((P=n==null?void 0:n.data)==null?void 0:P.podFiles)),n!=null&&n.data&&(d.pod_field_map=Object.values((S=n==null?void 0:n.data)==null?void 0:S.podFields).filter(x=>x.required).map(x=>({formField:"",podFormField:x.key,required:x.required})),((C=d==null?void 0:d.pod_field_map)==null?void 0:C.length)<1&&(d.pod_field_map=[{}])),m(d))})};p.useEffect(()=>{T({},"pods/list","","GET").then(t=>{const{data:s}=t;A(s==null?void 0:s.post_types),q(s.users)})},[]);const R=(t,s)=>{const d=u({},i);s?d.condition.action_behavior=t:d.condition.action_behavior="",m(d)},H=()=>{if(!i.post_type){h({show:!0,msg:a("Pod cann't be empty","bit-integrations")});return}if(!i.post_status){h({show:!0,msg:a("Post Status cann't be empty","bit-integrations")});return}if(!ee(i)){h({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}if(!te(i)){h({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}v(!0),Z(r,c,M,i,U,"","",v)};return e.jsxs("div",{style:{width:900},children:[e.jsx(W,{snack:B,setSnackbar:h}),(l==null?void 0:l.youTubeLink)&&e.jsx(I,{title:l==null?void 0:l.title,youTubeLink:l==null?void 0:l.youTubeLink}),(l==null?void 0:l.docLink)&&e.jsx(I,{title:l==null?void 0:l.title,docLink:l==null?void 0:l.docLink}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>b(t.target.name,t.target.value),name:"name",value:i.name,type:"text",placeholder:a("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Pod","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_type",onChange:t=>G(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Type"}),j==null?void 0:j.map((t,s)=>e.jsx("option",{value:t.name,children:t.label},`pod-${s*2}`))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Post Status","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_status",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"inherit",children:"Inherit"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private ",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Author","bit-integrations")})}),e.jsxs("select",{name:"post_author",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),O.map((t,s)=>e.jsx("option",{value:t.ID,children:t.display_name},`pod-${s*2}`))]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Post Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Post Fields","bit-integrations")})})]})]}),(_=i==null?void 0:i.post_map)==null?void 0:_.map((t,s)=>e.jsx(g,{i:s,type:"post",field:t,formFields:o,podsConf:i,setPodsConf:m,podFields:ie,fieldType:"fields"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("post_map",i.post_map.length,i,m),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),i.pod_field_map.map((t,s)=>e.jsx(g,{i:s,type:"pod",field:t,formFields:o,podsConf:i,setPodsConf:m,podFields:$,fieldType:"fields"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("pod_field_map",i.pod_field_map.length,i,m),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod File Upload Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),i.pod_file_map.map((t,s)=>e.jsx(g,{i:s,type:"podFile",field:t,formFields:o,podsConf:i,setPodsConf:m,podFields:E,fieldType:"file"},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("pod_file_map",i.pod_file_map.length,i,m),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),(i==null?void 0:i.condition)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flx",children:e.jsx(X,{onChange:t=>R(t.target.value,t.target.checked),checked:((N=i==null?void 0:i.condition)==null?void 0:N.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:a("Conditional Logics","bit_integration")})}),e.jsx("br",{}),((y=i==null?void 0:i.condition)==null?void 0:y.action_behavior)==="cond"&&e.jsx(se,{formFields:o,dataConf:i,setDataConf:m})]}),e.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:()=>H(),children:[a("Save","bit-integrations")," ",z&&e.jsx(Y,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{je as default};
