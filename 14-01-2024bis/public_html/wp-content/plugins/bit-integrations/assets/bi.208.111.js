var O=Object.defineProperty;var P=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var k=(o,n,d)=>n in o?O(o,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):o[n]=d,x=(o,n)=>{for(var d in n||(n={}))U.call(n,d)&&k(o,d,n[d]);if(P)for(var d of P(n))B.call(n,d)&&k(o,d,n[d]);return o};import{r as p,i as G,u as H,b as I,m as J,j as e}from"./main-577.js";import{g as K,h as Q,$ as V,E as X,c as b,e as Y,_ as l,ad as _}from"./bi.655.81.js";import{p as Z}from"./bi.895.712.js";import{E as T,a as ee}from"./bi.49.675.js";import{c as C,e as te}from"./bi.787.676.js";import{I as se}from"./bi.672.677.js";import{r as ie,F as ae,a as le,C as ne,c as de,b as re,d as oe}from"./bi.202.739.js";import"./bi.827.680.js";import"./bi.587.674.js";import"./bi.622.681.js";import"./bi.933.682.js";import"./bi.265.683.js";function Fe({allIntegURL:o}){var w;const[n,d]=p.useState([]),[f,N]=p.useState([]),M=G(),{formID:D,id:E}=H(),[s,h]=I(K),g=J(Q),[j,$]=I(V),[F,v]=p.useState(!1),[q,c]=p.useState({show:!1}),[A,y]=p.useState({fields:[],files:[]}),[R,S]=p.useState({fields:[],files:[]}),u=(t,i)=>{const a=x({},s);a[t]=i,h(a)};p.useEffect(()=>{const t=X(x({},s));b({},"user/list").then(i=>{const{data:a}=i;d(a)}),b({},"post-types/list").then(i=>{const{data:a}=i;N(a)}),b({post_type:s==null?void 0:s.post_type},"customfield/list").then(i=>{const{data:a}=i;y({fields:a.acf_fields,files:a.acf_files}),S({fields:a.mb_fields,files:a.mb_files})}),h(t)},[]);const z=(t,i)=>{const a=x({},s);a[t]=i,b({post_type:i},"customfield/list").then(L=>{const{data:r}=L;y({fields:r.acf_fields,files:r.acf_files}),S({fields:r.mb_fields,files:r.mb_files}),r!=null&&r.acf_fields&&(a.acf_map=r.acf_fields.filter(m=>m.required).map(m=>({formField:"",acfField:m.key,required:m.required})),a.acf_map.length<1&&(a.acf_map=[{}])),r!=null&&r.mb_fields&&(a.metabox_map=r.mb_fields.filter(m=>m.required).map(m=>({formField:"",metaboxField:m.key,required:m.required})),a.metabox_map.length<1&&(a.metabox_map=[{}]))}),h(a)},W=()=>{if(!de(s)){c({show:!0,msg:l("Please map mandatory fields","bit-integrations")});return}if(!re(s)){c({show:!0,msg:l("Please map mandatory fields","bit-integrations")});return}if(!oe(s)){c({show:!0,msg:l("Please map mandatory fields","bit-integrations")});return}v(!0),te(j,$,o,s,M,E,1,v).then(i=>{i.success?c({show:!0,msg:i.data}):c({show:!0,msg:i.data||i})})};return e.jsxs("div",{children:[e.jsx(Y,{snack:q,setSnackbar:c}),e.jsxs("div",{style:{width:900},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:l("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>u(t.target.name,t.target.value),name:"name",value:s.name,type:"text",placeholder:l("Integration Name...","bit-integrations")}),e.jsx("br",{}),e.jsx("br",{}),!C(j.triggered_entity)&&e.jsx(T,{setSnackbar:c,className:"d-blk"}),C(j.triggered_entity)&&e.jsx(ee,{setSnackbar:c}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:l("Post Type","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select one of the defined WordPress post types Or custom post types for the post.",e.jsx("br",{})]})})]}),e.jsxs("div",{children:[e.jsxs("select",{name:"post_type",value:s==null?void 0:s.post_type,onChange:t=>z(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Post Type"}),f==null?void 0:f.map((t,i)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.title},`acf-${i*2}`))]}),e.jsx("button",{onClick:()=>ie(f,N),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${l("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:l("Post Status","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled",e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",value:s==null?void 0:s.post_status,onChange:t=>u(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:l("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:l("Author","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the user to be assigned to the post.",e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",value:s==null?void 0:s.post_author,onChange:t=>u(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:l("Select Author","bit-integrations")}),n==null?void 0:n.map((t,i)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${i*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:l("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",value:s==null?void 0:s.comment_status,onChange:t=>u(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:l("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:l("Post Field Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Post Fields","bit-integrations")})})]})]}),(w=s==null?void 0:s.post_map)==null?void 0:w.map((t,i)=>e.jsx(ae,{i,type:"post",field:t,formFields:g,postConf:s,setPostConf:h,customFields:Z},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>le("post_map",s.post_map.length,s,h),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx("div",{children:e.jsx(ne,{formID:D,formFields:g,handleInput:t=>u(t,s),postConf:s,setPostConf:h,isLoading:F,setIsLoading:v,setSnackbar:c,acfFields:A,mbFields:R})}),e.jsx(se,{edit:!0,saveConfig:W,isLoading:F,dataConf:s,setDataConf:h,formFields:g})]})}export{Fe as default};
