var W=Object.defineProperty;var C=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(d,r,c)=>r in d?W(d,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[r]=c,x=(d,r)=>{for(var c in r||(r={}))G.call(r,c)&&I(d,c,r[c]);if(C)for(var c of C(r))H.call(r,c)&&I(d,c,r[c]);return d};import{r as u,i as J,u as K,j as e}from"./main-577.js";import{c as _,e as Q,_ as i,ad as N}from"./bi.655.81.js";import{S as V}from"./bi.880.909.js";import{r as X,F as Y,a as Z,C as ee,c as te,b as se,d as ie}from"./bi.202.739.js";import{p as L}from"./bi.895.712.js";import{e as ae}from"./bi.787.676.js";import{I as ne}from"./bi.672.677.js";import{T as q,t as le}from"./bi.934.737.js";import"./bi.587.674.js";import"./bi.622.681.js";import"./bi.933.682.js";import"./bi.265.683.js";import"./bi.827.680.js";function _e({formFields:d,setFlow:r,flow:c,allIntegURL:y}){var F;const[j,M]=u.useState([]),[g,S]=u.useState([]),w=J(),{formID:D}=K(),[P,v]=u.useState(!1),[b,A]=u.useState(1),[E,m]=u.useState({show:!1}),[T,$]=u.useState({fields:[],files:[]}),[z,O]=u.useState({fields:[],files:[]}),{postCreation:n}=le,[a,h]=u.useState({name:"Post Creation",type:"Post Creation",post_map:[{post_author:"logged_in_user"}],acf_map:[{}],acf_file_map:[{}],metabox_map:[{}],metabox_file_map:[{}]}),f=(t,s)=>{const l=x({},a);l[t]=s,h(l)};u.useEffect(()=>{_({},"user/list").then(s=>{const{data:l}=s;M(l)}),_({},"post-types/list").then(s=>{const{data:l}=s;S(l)});const t=x({},a);t.post_map=L.filter(s=>s.required).map(s=>({formField:"",postField:s.key,required:s.required})),h(t)},[]);const B=(t,s)=>{const l=x({},a);l[t]=s,_({post_type:s},"customfield/list").then(U=>{const{data:o}=U;$({fields:o.acf_fields,files:o.acf_files}),O({fields:o.mb_fields,files:o.mb_files}),o!=null&&o.acf_fields&&(l.acf_map=o.acf_fields.filter(p=>p.required).map(p=>({formField:"",acfField:p.key,required:p.required})),l.acf_map.length<1&&(l.acf_map=[{}])),o!=null&&o.mb_fields&&(l.metabox_map=o.mb_fields.filter(p=>p.required).map(p=>({formField:"",metaboxField:p.key,required:p.required})),l.metabox_map.length<1&&(l.metabox_map=[{}]))}),h(l)},k=t=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!te(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!a.post_type){m({show:!0,msg:i("Post Type cann't be empty","bit-integrations")});return}if(!a.post_status){m({show:!0,msg:i("Post Status cann't be empty","bit-integrations")});return}if(t===3){if(!se(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!ie(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}}A(t)},R=()=>{v(!0),ae(c,r,y,a,w,"","",v).then(s=>{var l;s.success?(m({show:!0,msg:(l=s.data)==null?void 0:l.msg}),w(y)):m({show:!0,msg:s.data||s})})};return e.jsxs("div",{children:[e.jsx(Q,{snack:E,setSnackbar:m}),(n==null?void 0:n.youTubeLink)&&e.jsx(q,{title:n==null?void 0:n.title,youTubeLink:n==null?void 0:n.youTubeLink}),(n==null?void 0:n.docLink)&&e.jsx(q,{title:n==null?void 0:n.title,docLink:n==null?void 0:n.docLink}),e.jsx("div",{className:"txt-center mt-2",children:e.jsx(V,{step:3,active:b})}),e.jsxs("div",{className:"btcd-stp-page",style:{width:b===1&&900,height:b===1&&"auto"},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>f(t.target.name,t.target.value),name:"name",value:a.name,type:"text",placeholder:i("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Post Type","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select one of the defined WordPress post types Or custom post types for the post.",e.jsx("br",{})]})})]}),e.jsxs("div",{children:[e.jsxs("select",{name:"post_type",onChange:t=>B(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Post Type"}),g==null?void 0:g.map((t,s)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.title},`acf-${s*2}`))]}),e.jsx("button",{onClick:()=>X(g,S),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:i("Post Status","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled",e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Author","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the user to be assigned to the post.",e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),j==null?void 0:j.map((t,s)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${s*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:i("Post Field Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Post Fields","bit-integrations")})})]})]}),(F=a==null?void 0:a.post_map)==null?void 0:F.map((t,s)=>e.jsx(Y,{i:s,type:"post",field:t,formFields:d,postConf:a,setPostConf:h,customFields:L},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>Z("post_map",a.post_map.length,a,h),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("button",{onClick:()=>k(2),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsxs("div",{className:"btcd-stp-page",style:x({},b===2&&{width:900,height:"auto",overflow:"visible"}),children:[e.jsx(ee,{formID:D,formFields:d,handleInput:t=>f(t,a),postConf:a,setPostConf:h,isLoading:P,setIsLoading:v,setSnackbar:m,acfFields:T,mbFields:z}),e.jsxs("button",{onClick:()=>k(3),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsx(ne,{step:b,saveConfig:()=>R(),isLoading:P,dataConf:a,setDataConf:h,formFields:d})]})}export{_e as default};
