var T=Object.defineProperty;var j=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var v=(o,n,a)=>n in o?T(o,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[n]=a,m=(o,n)=>{for(var a in n||(n={}))$.call(n,a)&&v(o,a,n[a]);if(j)for(var a of j(n))q.call(n,a)&&v(o,a,n[a]);return o};import{i as A,u as B,r as h,b as w,m as D,j as t}from"./main-577.js";import{$ as W,h as z,g as G,c as H,e as O,_ as c,a6 as J,a8 as k,L as K}from"./bi.655.81.js";import{c as y,s as Q}from"./bi.787.676.js";import{u as F,U as V,C as X,c as Y}from"./bi.337.738.js";import{E as Z,a as ee}from"./bi.49.675.js";import{C as te}from"./bi.827.680.js";import{C}from"./bi.515.695.js";import"./bi.587.674.js";import"./bi.622.681.js";import"./bi.933.682.js";import"./bi.265.683.js";function pe({allIntegURL:o}){var b,_;const n=A(),{formID:a}=B(),[U,d]=h.useState({show:!1}),[E,I]=h.useState([]),[f,N]=h.useState(!1),[p,L]=w(W),g=D(z),[e,u]=w(G);h.useEffect(()=>{var l,r;const s=m({},e);H({},"role/list",null,"GET").then(i=>{i!=null&&i.success&&i!==void 0&&I(Object.values(i==null?void 0:i.data))}),(r=(l=s==null?void 0:s.user_map)==null?void 0:l[0])!=null&&r.userField||(s.user_map=F.filter(i=>i.required).map(i=>({formField:"",userField:i.key,required:i.required}))),u(s)},[]);const R=()=>{if(!e.action_type){d({show:!0,msg:c("Please select action type","bit-integrations")});return}if(!e.user_role&&e.action_type!=="updated_user"){d({show:!0,msg:c("User Role can't be empty","bit-integrations")});return}if(!Y(e)&&e.action_type!=="updated_user"){d({show:!0,msg:c("Please map mandatory fields","bit-integrations")});return}Q({flow:p,setFlow:L,allIntegURL:o,conf:e,navigate:n,edit:1,setIsLoading:N,setSnackbar:d})},S=(s,l)=>{const r=m({},e);l?r.condition.action_behavior=s:r.condition.action_behavior="",u(r)},x=s=>{const l=m({},e),{name:r,value:i}=s.target;s.target.checked&&(l[r]=i),u(m({},l))},M=`
  <ul>
  <li>The user must be logged in when updating profile</li>
  <li>The user cannot change the value of the username field when updating the user profile.</li>
     
  </ul>`,P=`
  <ul>
  <li>If the Username and Password fields are blank then the user will take the value of the email field as the field and the password will be auto-generated.</li>
     
  </ul>`;return t.jsxs("div",{children:[t.jsx(O,{snack:U,setSnackbar:d}),t.jsx("br",{}),!y(p.triggered_entity)&&t.jsx(Z,{setSnackbar:d}),y(p.triggered_entity)&&t.jsx(ee,{setSnackbar:d}),t.jsx("div",{className:"font-w-m mt-3",children:c("Action type","bit-integrations")}),t.jsxs("div",{children:[t.jsx(C,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="new_user",value:"new_user",title:c("New User Create","bit-integrations")}),t.jsx(C,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="updated_user",value:"updated_user",title:c("Updated User","bit-integrations")})]}),t.jsx("div",{children:t.jsx(V,{formFields:g,formID:a,userConf:e,setUserConf:u,roles:E,userFields:F})}),t.jsxs("div",{children:[t.jsx(X,{formFields:g,formID:a,userConf:e,setUserConf:u}),t.jsx("br",{})]}),(e==null?void 0:e.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(J,{onChange:s=>S(s.target.value,s.target.checked),checked:((b=e==null?void 0:e.condition)==null?void 0:b.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:c("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((_=e==null?void 0:e.condition)==null?void 0:_.action_behavior)==="cond"&&t.jsx(te,{formFields:g,dataConf:e,setDataConf:u})]}),(e==null?void 0:e.action_type)==="updated_user"?t.jsx(k,{note:M}):t.jsx(k,{note:P}),t.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:R,disabled:f,children:[c("Update","bit-integrations"),f&&t.jsx(K,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{pe as default};
